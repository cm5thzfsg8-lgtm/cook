<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í‡´ê·¼ìš”ì • ìŒ¤ë´‡ - ë§ì¶¤í˜• ìˆ˜ì—… ë¹„ì„œ</title>
    <style>
        body { font-family: 'Pretendard', -apple-system, system-ui, sans-serif; background-color: #f0fdf4; color: #333; margin: 0; display: flex; justify-content: center; }
        .container { width: 100%; max-width: 500px; background-color: #fff; min-height: 100vh; padding: 20px; box-sizing: border-box; box-shadow: 0 0 15px rgba(0,0,0,0.05); }
        h1 { color: #16a34a; text-align: center; font-size: 24px; margin-bottom: 5px; }
        p.subtitle { text-align: center; color: #666; font-size: 14px; margin-bottom: 20px; }
        .api-setup { background-color: #f1f5f9; padding: 15px; border-radius: 10px; margin-bottom: 20px; font-size: 13px; }
        .api-setup input { width: 100%; padding: 8px; margin-top: 8px; box-sizing: border-box; border: 1px solid #cbd5e1; border-radius: 6px; }
        .input-group { display: flex; flex-direction: column; gap: 12px; }
        .row { display: flex; gap: 10px; }
        input[type="text"], select { padding: 12px; font-size: 15px; border: 2px solid #bbf7d0; border-radius: 8px; outline: none; box-sizing: border-box; }
        input[type="text"]:focus, select:focus { border-color: #22c55e; }
        
        #grade { width: 40%; }
        #subject { width: 60%; }
        #topic { width: 100%; }

        button.submit-btn { background-color: #22c55e; color: white; border: none; padding: 15px; font-size: 16px; font-weight: bold; border-radius: 8px; cursor: pointer; margin-top: 10px; transition: 0.2s; }
        button.submit-btn:hover { background-color: #16a34a; }
        #loading { display: none; text-align: center; color: #16a34a; font-weight: bold; margin-top: 20px; }
        #result-section { display: none; margin-top: 25px; }
        .ai-plan { background-color: #f8fafc; padding: 20px; border-radius: 10px; border: 1px solid #e2e8f0; line-height: 1.6; font-size: 15px; }
        .links-box { margin-top: 20px; display: flex; flex-direction: column; gap: 10px; }
        .link-btn { display: inline-block; padding: 12px; text-align: center; border-radius: 8px; text-decoration: none; font-weight: bold; color: white; }
        
        .youtube-btn { background-color: #ef4444; }
        .google-web-btn { background-color: #3b82f6; } 
        .google-img-btn { background-color: #10b981; } 
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ§š í‡´ê·¼ìš”ì • ìŒ¤ë´‡</h1>
    <p class="subtitle">10ì´ˆ ë§Œì— ëë‚´ëŠ” ì°¨ì‹œë³„ ìˆ˜ì—… ì•„ì´ë””ì–´ & ìë£Œ ê²€ìƒ‰</p>

    <div class="api-setup" id="api-setup-box">
        <strong>ğŸ”‘ ì¤€ë¹„ë¬¼: Google Gemini API í‚¤</strong><br>
        <span style="color:#64748b;">(ë¸Œë¼ìš°ì €ì— ì•ˆì „í•˜ê²Œ ì €ì¥ë©ë‹ˆë‹¤)</span>
        <input type="password" id="api-key" placeholder="AIzaSy... ë¡œ ì‹œì‘í•˜ëŠ” í‚¤ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”">
        <button onclick="saveApiKey()" style="margin-top:8px; padding:5px 10px; cursor:pointer;">í‚¤ ì €ì¥í•˜ê¸°</button>
    </div>

    <div class="input-group">
        <div class="row">
            <select id="grade">
                <option value="ì´ˆë“± 1í•™ë…„">1í•™ë…„</option><option value="ì´ˆë“± 2í•™ë…„">2í•™ë…„</option>
                <option value="ì´ˆë“± 3í•™ë…„">3í•™ë…„</option><option value="ì´ˆë“± 4í•™ë…„">4í•™ë…„</option>
                <option value="ì´ˆë“± 5í•™ë…„">5í•™ë…„</option><option value="ì´ˆë“± 6í•™ë…„">6í•™ë…„</option>
            </select>
            <input type="text" id="subject" placeholder="ê³¼ëª© (ì˜ˆ: ì˜ì–´, ë¯¸ìˆ , ì‹¤ê³¼)">
        </div>
        <input type="text" id="topic" placeholder="ì˜¤ëŠ˜ì˜ í•µì‹¬ ëª©í‘œ (ì˜ˆ: í•™êµ ì‹œì„¤ íƒë°©)">
        <button class="submit-btn" onclick="generateLesson()">ìˆ˜ì—… ë¹„ì„œ í˜¸ì¶œí•˜ê¸° ğŸš€</button>
    </div>

    <div id="loading">AIì™€ êµì‚¬ê°€ í•¨ê»˜ ë©‹ì§„ ìˆ˜ì—…ì„ ë§Œë“¤ì–´ë‚˜ê°€ëŠ” ì¤‘... â³</div>

    <div id="result-section">
        <h3 style="color:#16a34a;">ğŸ“ ì˜¤ëŠ˜ì˜ ìˆ˜ì—… ì œì•ˆ & ì•Œë¦¼ì¥</h3>
        <div class="ai-plan" id="ai-content"></div>
        <h3 style="color:#16a34a; margin-top:30px;">ğŸ¯ ë§ì¶¤í˜• ìë£Œ ë°”ë¡œ ì°¾ê¸°</h3>
        <p style="font-size:13px; color:#666; margin-top:-5px;">(AIê°€ ì¶”ì²œí•œ í™œë™ì— ë§ì¶° ìµœì í™”ëœ ê²€ìƒ‰ì–´ì…ë‹ˆë‹¤)</p>
        <div class="links-box" id="dynamic-links"></div>
    </div>
</div>

<script>
    window.onload = function() {
        const savedKey = localStorage.getItem('geminiApiKey');
        if (savedKey) {
            document.getElementById('api-key').value = savedKey;
            document.getElementById('api-setup-box').style.display = 'none';
        }
    };

    function saveApiKey() {
        const key = document.getElementById('api-key').value.trim(); 
        if(key) {
            localStorage.setItem('geminiApiKey', key);
            alert('API í‚¤ê°€ ì•ˆì „í•˜ê²Œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
            document.getElementById('api-setup-box').style.display = 'none';
        }
    }

    async function generateLesson() {
        const apiKey = (localStorage.getItem('geminiApiKey') || document.getElementById('api-key').value).trim();
        const grade = document.getElementById('grade').value;
        const subject = document.getElementById('subject').value.trim(); 
        const topic = document.getElementById('topic').value.trim();

        if (!apiKey) { alert("API í‚¤ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”!"); return; }
        if (!subject) { alert("ê³¼ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”! (ì˜ˆ: ë„ë•, ì˜ì–´)"); return; }
        if (!topic) { alert("ì˜¤ëŠ˜ì˜ í•µì‹¬ ëª©í‘œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!"); return; }

        document.getElementById('result-section').style.display = 'none';
        document.getElementById('loading').style.display = 'block';

        // â˜… í”„ë¡¬í”„íŠ¸ ëŒ€í­ ìˆ˜ì •: AIì—ê²Œ ì–‘ì‹ì„ ê°•ì œí•˜ê³  ê²€ìƒ‰ì–´ë¥¼ ì§ì ‘ ë½‘ê²Œ í•¨ â˜…
        const prompt = `ë‹¹ì‹ ì€ íƒì›”í•œ ì´ˆë“±í•™êµ êµì‚¬ì…ë‹ˆë‹¤. ì•„ë˜ ëŒ€ìƒê³¼ ëª©í‘œë¥¼ ë°”íƒ•ìœ¼ë¡œ 40ë¶„ ë¶„ëŸ‰ì˜ ìˆ˜ì—… ê³„íšì„ ì§œê³ , ê·¸ ìˆ˜ì—… í™œë™ì— ì •í™•íˆ ë§ì•„ë–¨ì–´ì§€ëŠ” ê²€ìƒ‰ì–´ 3ê°œë¥¼ ì¶”ì¶œí•´ ì£¼ì„¸ìš”.

        [ì¡°ê±´]
        1. ìˆ˜ì—…ì€ í•™ìƒ ì°¸ì—¬í˜•(ë†€ì´, í€´ì¦ˆ, ì¡°ì‘ ë“±) ìœ„ì£¼ë¡œ [ë„ì…], [ì „ê°œ], [ì •ë¦¬]ë¡œ ëª…í™•íˆ ë‚˜ëˆŒ ê²ƒ.
        2. ë§ˆì§€ë§‰ì— **[í•™ë¶€ëª¨ ì•Œë¦¼ì¥ ì¶”ì²œ ë¬¸êµ¬]**ë¥¼ í¬í•¨í•  ê²ƒ (êµ¬ì²´ì  í™œë™ ë¬˜ì‚¬ ëŒ€ì‹  êµìœ¡ì  ì˜ë¯¸ì™€ ê°€ì • ì—°ê³„ ëŒ€í™” ìœ„ì£¼).
        3. ì•„ë˜ì˜ ì–‘ì‹ì„ ë°˜ë“œì‹œ ì—„ê²©í•˜ê²Œ ì§€ì¼œì„œ ë‹µë³€í•  ê²ƒ. (ëŒ€ê´„í˜¸ íƒœê·¸ë¥¼ ê¼­ ì“¸ ê²ƒ)

        [ìˆ˜ì—…ê³„íš]
        (ì—¬ê¸°ì— ìˆ˜ì—… ê³„íšê³¼ ì•Œë¦¼ì¥ ë‚´ìš© ì‘ì„±. "ì„ ìƒë‹˜~" í•˜ëŠ” ë‹¤ì •í•œ ë§íˆ¬ ì‚¬ìš©)
        [ìœ íŠœë¸Œê²€ìƒ‰ì–´]
        (ìœ„ ìˆ˜ì—…ì˜ ë™ê¸°ìœ ë°œì— ë³´ì—¬ì£¼ê¸° ë”± ì¢‹ì€ êµ¬ì²´ì ì¸ ìœ íŠœë¸Œ ê²€ìƒ‰ì–´ ë”± 1ê°œ. ì˜ˆ: ì´ˆë“± 1í•™ë…„ í•™êµ íƒë°© ì• ë‹ˆë©”ì´ì…˜)
        [êµ¬ê¸€ê²€ìƒ‰ì–´]
        (ìœ„ ìˆ˜ì—…ì˜ ì „ê°œ í™œë™ì— í•„ìš”í•œ í•™ìŠµì§€ë‚˜ PPTë¥¼ ì°¾ê¸° ì¢‹ì€ êµ¬ì²´ì ì¸ êµ¬ê¸€ ì›¹ ê²€ìƒ‰ì–´ ë”± 1ê°œ. ì˜ˆ: í•™êµ ì‹œì„¤ ë¹™ê³  ë„ì•ˆ ppt)
        [ì´ë¯¸ì§€ê²€ìƒ‰ì–´]
        (ìœ„ ìˆ˜ì—…ì— í•„ìš”í•œ ì‹œê° ìë£Œë¥¼ ì°¾ê¸° ì¢‹ì€ êµ¬ì²´ì ì¸ êµ¬ê¸€ ì´ë¯¸ì§€ ê²€ìƒ‰ì–´ ë”± 1ê°œ. ì˜ˆ: ê·€ì—¬ìš´ í•™êµ ì§€ë„ ì¼ëŸ¬ìŠ¤íŠ¸)

        ëŒ€ìƒ: ${grade} ${subject}, í•™ìŠµëª©í‘œ: ${topic}`;

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: prompt }] }]
                })
            });

            const data = await response.json();
            
            if(data.error) {
                alert("êµ¬ê¸€ ì„œë²„ ì—ëŸ¬:\n" + data.error.message);
                document.getElementById('loading').style.display = 'none';
                return;
            }

            const fullText = data.candidates[0].content.parts[0].text;

            // â˜… AIê°€ ë³´ë‚´ì¤€ í…ìŠ¤íŠ¸ë¥¼ ìª¼ê°œì„œ(íŒŒì‹±) ë‚´ìš©ê³¼ ê²€ìƒ‰ì–´ë¥¼ ë¶„ë¦¬í•˜ëŠ” ë§ˆë²• â˜…
            let lessonPlan = fullText;
            let ytQuery = `ì´ˆë“± ${topic} ë™ê¸°ìœ ë°œ`;
            let webQuery = `${grade} ${subject} ${topic} í™œë™ì§€`;
            let imgQuery = `ì´ˆë“± ${topic} ì‹œê°ìë£Œ`;

            if(fullText.includes('[ìœ íŠœë¸Œê²€ìƒ‰ì–´]')) {
                const parts = fullText.split('[ìœ íŠœë¸Œê²€ìƒ‰ì–´]');
                lessonPlan = parts[0].replace('[ìˆ˜ì—…ê³„íš]', '').trim();
                
                const remaining1 = parts[1];
                if(remaining1.includes('[êµ¬ê¸€ê²€ìƒ‰ì–´]')) {
                    const parts2 = remaining1.split('[êµ¬ê¸€ê²€ìƒ‰ì–´]');
                    ytQuery = parts2[0].trim();
                    
                    const remaining2 = parts2[1];
                    if(remaining2.includes('[ì´ë¯¸ì§€ê²€ìƒ‰ì–´]')) {
                        const parts3 = remaining2.split('[ì´ë¯¸ì§€ê²€ìƒ‰ì–´]');
                        webQuery = parts3[0].trim();
                        imgQuery = parts3[1].trim();
                    }
                }
            }

            document.getElementById('ai-content').innerHTML = lessonPlan.replace(/\n/g, '<br>');

            document.getElementById('dynamic-links').innerHTML = `
                <a href="https://www.youtube.com/results?search_query=${encodeURIComponent(ytQuery)}" target="_blank" class="link-btn youtube-btn">â–¶ï¸ ìœ íŠœë¸Œ ê²€ìƒ‰: "${ytQuery}"</a>
                <a href="https://www.google.com/search?q=${encodeURIComponent(webQuery)}" target="_blank" class="link-btn google-web-btn">ğŸ” êµ¬ê¸€ ì›¹ ê²€ìƒ‰: "${webQuery}"</a>
                <a href="https://www.google.com/search?tbm=isch&q=${encodeURIComponent(imgQuery)}" target="_blank" class="link-btn google-img-btn">ğŸ–¼ï¸ ì´ë¯¸ì§€ ê²€ìƒ‰: "${imgQuery}"</a>
            `;

            document.getElementById('loading').style.display = 'none';
            document.getElementById('result-section').style.display = 'block';

        } catch (error) {
            alert("í†µì‹  ì˜¤ë¥˜ ë°œìƒ:\n" + error.message);
            document.getElementById('loading').style.display = 'none';
        }
    }
</script>

</body>
</html>
